import unittest
from Problems.problem_B import SudokuPuzzleValidator

class TestSudokuPuzzleValidator(unittest.TestCase):
    def test_validate_rows_empty_grid(self):
        grid = [
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
        ]

        validator = SudokuPuzzleValidator(grid)
        self.assertTrue(validator.validate_rows())

    def test_validate_rows_valid(self):
        grid = [
            ["1","2","3","4","5","6","7","8","9"],
            ["4","5","6","7","8","9","1","2","3"],
            ["7","8","9","1","2","3","4","5","6"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
        ]

        validator = SudokuPuzzleValidator(grid)
        self.assertTrue(validator.validate_rows())

    def test_validate_rows_invalid_duplicate(self):
        grid = [
            ["1","2","3","4","5","6","7","8","1"],  # duplicate 1 in first row
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
        ]

        validator = SudokuPuzzleValidator(grid)
        self.assertFalse(validator.validate_rows())

    def test_validate_rows_valid_scattered(self):
        grid = [
            ["5","3","*","*","7","*","*","*","*"],
            ["6","*","*","1","9","5","*","*","*"],
            ["*","9","8","*","*","*","*","6","*"],
            ["8","*","*","*","6","*","*","*","3"],
            ["4","*","*","8","*","3","*","*","1"],
            ["7","*","*","*","2","*","*","*","6"],
            ["*","6","*","*","*","*","2","8","*"],
            ["*","*","*","4","1","9","*","*","5"],
            ["*","*","*","*","8","*","*","7","9"],
        ]

        validator = SudokuPuzzleValidator(grid)
        self.assertTrue(validator.validate_rows())

    def test_validate_rows_invalid_scattered(self):
        grid = [
            ["5","3","*","*","7","*","*","*","*"],
            ["6","*","*","1","9","5","*","*","*"],
            ["*","9","8","*","*","*","*","6","*"],
            ["8","*","*","*","6","*","*","*","3"],
            ["4","*","*","8","*","3","*","*","1"],
            ["7","*","*","*","2","*","*","7","6"],  # duplicate 7 in row 6
            ["*","6","*","*","*","*","2","8","*"],
            ["*","*","*","4","1","9","*","*","5"],
            ["*","*","*","*","8","*","*","7","9"],
        ]

        validator = SudokuPuzzleValidator(grid)
        self.assertFalse(validator.validate_rows())

    def test_validate_cols_empty_grid(self):
        grid = [
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
        ]

        validator = SudokuPuzzleValidator(grid)
        self.assertTrue(validator.validate_cols())

    def test_validate_cols_valid(self):
        grid = [
            ["1","*","*","*","*","*","*","*","*"],
            ["2","*","*","*","*","*","*","*","*"],
            ["3","*","*","*","*","*","*","*","*"],
            ["4","*","*","*","*","*","*","*","*"],
            ["5","*","*","*","*","*","*","*","*"],
            ["6","*","*","*","*","*","*","*","*"],
            ["7","*","*","*","*","*","*","*","*"],
            ["8","*","*","*","*","*","*","*","*"],
            ["9","*","*","*","*","*","*","*","*"],
        ]

        validator = SudokuPuzzleValidator(grid)
        self.assertTrue(validator.validate_cols())

    def test_validate_cols_invalid_duplicate(self):
        grid = [
            ["5","*","*","*","*","*","*","*","*"],
            ["2","*","*","*","*","*","*","*","*"],
            ["3","*","*","*","*","*","*","*","*"],
            ["4","*","*","*","*","*","*","*","*"],
            ["5","*","*","*","*","*","*","*","*"],  # duplicate 5 in first column
            ["6","*","*","*","*","*","*","*","*"],
            ["7","*","*","*","*","*","*","*","*"],
            ["8","*","*","*","*","*","*","*","*"],
            ["9","*","*","*","*","*","*","*","*"],
        ]

        validator = SudokuPuzzleValidator(grid)
        self.assertFalse(validator.validate_cols())

    def test_validate_cols_valid_scattered(self):
        grid = [
            ["5","3","*","*","7","*","*","*","*"],
            ["6","*","*","1","9","5","*","*","*"],
            ["*","9","8","*","*","*","*","6","*"],
            ["8","*","*","*","6","*","*","*","3"],
            ["4","*","*","8","*","3","*","*","1"],
            ["7","*","*","*","2","*","*","*","6"],
            ["*","6","*","*","*","*","2","8","*"],
            ["*","*","*","4","1","9","*","*","5"],
            ["*","*","*","*","8","*","*","7","9"],
        ]

        validator = SudokuPuzzleValidator(grid)
        self.assertTrue(validator.validate_cols())

    def test_validate_cols_invalid_scattered(self):
        grid = [
            ["5","3","*","*","7","*","*","*","*"],
            ["6","*","*","1","9","5","*","*","*"],
            ["*","9","8","*","*","*","*","6","*"],
            ["8","*","*","*","6","*","*","*","3"],
            ["4","*","*","8","*","3","*","*","1"],
            ["7","*","*","*","2","*","*","*","6"],
            ["*","6","*","*","*","*","2","8","*"],
            ["*","*","*","4","1","9","*","*","5"],
            ["*","*","*","*","8","*","*","8","9"],  # duplicate 8 in column 8
        ]

        validator = SudokuPuzzleValidator(grid)
        self.assertFalse(validator.validate_cols())

    def test_validate_boxes(self):
        grid = [
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
        ]

        validator = SudokuPuzzleValidator(grid)
        self.assertTrue(validator.validate_boxes())

    def test_validate_boxes_valid(self):
        grid = [
            ["1","2","3","*","*","*","*","*","*"],
            ["4","5","6","*","*","*","*","*","*"],
            ["7","8","9","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
        ]

        validator = SudokuPuzzleValidator(grid)
        self.assertTrue(validator.validate_boxes())

    def test_validate_boxes_invalid_duplicate(self):
        grid = [
            ["1","2","3","*","*","*","*","*","*"],
            ["4","5","6","*","*","*","*","*","*"],
            ["7","8","1","*","*","*","*","*","*"],  # duplicate 1 in top-left box
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
            ["*","*","*","*","*","*","*","*","*"],
        ]

        validator = SudokuPuzzleValidator(grid)
        self.assertFalse(validator.validate_boxes())

    def test_validate_boxes_valid_scattered(self):
        grid = [
            ["5","3","*","*","7","*","*","*","*"],
            ["6","*","*","1","9","5","*","*","*"],
            ["*","9","8","*","*","*","*","6","*"],
            ["8","*","*","*","6","*","*","*","3"],
            ["4","*","*","8","*","3","*","*","1"],
            ["7","*","*","*","2","*","*","*","6"],
            ["*","6","*","*","*","*","2","8","*"],
            ["*","*","*","4","1","9","*","*","5"],
            ["*","*","*","*","8","*","*","7","9"],
        ]

        validator = SudokuPuzzleValidator(grid)
        self.assertTrue(validator.validate_boxes())

    def test_validate_boxes_invalid_scattered(self):
        grid = [
            ["5","3","*","*","7","*","*","*","*"],
            ["6","*","*","1","9","5","*","*","*"],
            ["*","9","8","*","*","*","*","6","*"],
            ["8","*","*","*","6","*","*","*","3"],
            ["4","*","*","8","*","3","*","*","1"],
            ["7","*","*","*","2","*","*","*","6"],
            ["*","6","*","*","*","*","2","8","*"],
            ["*","*","*","4","1","9","*","2","5"],  # duplicate 2 in bottom-right box
            ["*","*","*","*","8","*","*","7","9"],
        ]

        validator = SudokuPuzzleValidator(grid)
        self.assertFalse(validator.validate_boxes())
